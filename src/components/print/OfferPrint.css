/* ==========================================================================
   Offer Print Template Styles
   HTML-based PDF generation with proper print support
   ========================================================================== */

/* --------------------------------------------------------------------------
   CSS Custom Properties (Design Tokens)
   -------------------------------------------------------------------------- */
:root {
	--print-primary: #2980b9;
	--print-secondary: #34495e;
	--print-text: #1e1e1e;
	--print-text-muted: #505050;
	--print-border: #c8c8c8;
	--print-border-light: #dcdcdc;
	--print-bg-header: #f0f0f0;
	--print-white: #ffffff;
	--print-font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
	--print-font-arabic: 'Cairo', 'Amiri', 'Segoe UI', Tahoma, sans-serif;
}

/* --------------------------------------------------------------------------
   Base Container
   -------------------------------------------------------------------------- */
.offer-print-container {
	position: relative;
	width: 100%;
	margin: 0;
	padding: 0;
	background: transparent;
	font-family: var(--print-font-family);
	font-size: 10pt;
	color: var(--print-text);
	line-height: 1.4;
	box-sizing: border-box;
}

/* RTL Support */
.offer-print-container.rtl {
	direction: rtl;
	font-family: var(--print-font-arabic);
}

.offer-print-container.ltr {
	direction: ltr;
}

/* --------------------------------------------------------------------------
   Letterhead Background (not used - moved to product-page)
   -------------------------------------------------------------------------- */
.letterhead-background {
	display: none;
}

/* --------------------------------------------------------------------------
   Page Content - CONTENT completely separate from letterhead
   CONTENT is 50% of page (25% top + 25% bottom = 50% total)
   Content is positioned independently - letterhead does NOT affect it
   If content exceeds this 50% area, it automatically wraps to next page via CSS page-break
   -------------------------------------------------------------------------- */
.page-content {
	position: relative;
	z-index: 2; /* Above letterhead background */
	padding: 25% 15mm 25% 15mm; /* CONTENT padding: 25% top, 25% bottom, 15mm sides - ALWAYS */
	/* Content area = 100% - 25% (top) - 25% (bottom) = 50% of page */
	margin: 0; /* No margin - completely separate from letterhead */
	box-sizing: border-box;
	background: transparent; /* No background - letterhead is separate layer */
	/* Content positioning is independent - letterhead is just a visual background */
	/* Page-break properties handle wrapping when content exceeds 50% */
}

/* --------------------------------------------------------------------------
   Header Section
   -------------------------------------------------------------------------- */
.offer-header {
	margin-bottom: 12pt;
}

.date-section {
	margin-bottom: 8pt;
	font-size: 11pt;
}

.date-section .label {
	font-weight: 600;
	color: var(--print-secondary);
}

.date-section .value {
	margin-inline-start: 8pt;
	color: var(--print-secondary);
}

.client-greeting {
	font-size: 11pt;
	color: var(--print-secondary);
	margin-bottom: 8pt;
}

.document-intro {
	font-size: 10pt;
	color: var(--print-secondary);
	line-height: 1.5;
	margin: 0;
}

/* --------------------------------------------------------------------------
   Section Titles
   -------------------------------------------------------------------------- */
.section-title {
	font-size: 13pt;
	font-weight: 700;
	color: var(--print-primary);
	margin: 16pt 0 8pt 0;
	padding: 0;
}

/* --------------------------------------------------------------------------
   Products Table
   -------------------------------------------------------------------------- */
.products-section {
	margin-top: 8pt;
}

.products-table {
	width: 100%;
	border-collapse: collapse;
	border: 1px solid var(--print-border);
	margin-bottom: 12pt;
	table-layout: fixed;
}

.products-table th,
.products-table td {
	border: 1px solid var(--print-border);
	padding: 8pt 6pt;
	vertical-align: top;
	text-align: start;
}

.products-table thead th {
	background: var(--print-bg-header);
	font-weight: 600;
	font-size: 9pt;
	color: var(--print-primary);
	text-align: center;
}

/* Column Widths */
.col-product {
	width: 25%;
}

.col-image {
	width: 25%;
	text-align: center;
}

.col-provider {
	width: 25%;
}

.col-price {
	width: 15%;
	text-align: end;
}

/* Product Page Container - LETTERHEAD as background only, completely separate from content */
.product-page {
	position: relative;
	width: 210mm;
	min-height: 297mm;
	height: 297mm; /* Fixed height to ensure letterhead covers full page */
	margin: 0;
	padding: 0;
	background-color: var(--print-white);
	/* LETTERHEAD: Background layer only - does NOT affect content positioning */
	background-image: var(--letterhead-url);
	background-repeat: no-repeat;
	background-size: 100% 100%; /* Cover entire page - use 100% 100% instead of cover for better export */
	background-position: center center;
	box-sizing: border-box;
	page-break-after: always;
	page-break-inside: avoid;
	-webkit-print-color-adjust: exact;
	print-color-adjust: exact;
	image-rendering: -webkit-optimize-contrast;
	image-rendering: pixelated;
	image-rendering: crisp-edges;
}

.product-page:last-child {
	page-break-after: auto;
}

/* Product Row */
.product-row {
	page-break-inside: avoid;
	height: 50mm; /* Fixed row height */
	vertical-align: top;
}

/* When 2 products are on same page, ensure they fit within 50% content area */
/* If content exceeds 50% area, second product should wrap to next page */
.product-row:nth-child(2) {
	page-break-before: auto; /* Allow page break before second product if content exceeds 50% */
}

.product-row:nth-child(even) {
	background: rgba(240, 240, 240, 0.3);
}

.product-row td {
	vertical-align: middle;
	padding: 8pt;
}

/* Product Cell Content */
.product-name {
	font-size: 11pt;
	font-weight: 600;
	color: var(--print-text);
	margin-bottom: 4pt;
}

.product-description {
	font-size: 9pt;
	color: var(--print-text-muted);
	line-height: 1.3;
	margin-bottom: 4pt;
}

.product-model {
	font-size: 9pt;
	color: var(--print-text-muted);
	font-style: italic;
}

/* Product Image */
.product-image {
	width: 50mm;
	height: 50mm;
	object-fit: contain;
	display: block;
	margin: 0 auto;
	image-rendering: -webkit-optimize-contrast;
	image-rendering: crisp-edges;
	-webkit-print-color-adjust: exact;
	print-color-adjust: exact;
}

.no-image-placeholder {
	display: flex;
	align-items: center;
	justify-content: center;
	width: 50mm;
	height: 50mm;
	border: 1px dashed var(--print-border);
	background: #fafafa;
	color: var(--print-text-muted);
	font-size: 8pt;
	margin: 0 auto;
}

/* Provider Info */
.provider-info {
	display: flex;
	flex-direction: column;
	align-items: flex-start;
	gap: 4pt;
	margin-bottom: 6pt;
}

.rtl .provider-info {
	align-items: flex-end;
}

.provider-logo {
	width: 35mm;
	height: 15mm;
	object-fit: contain;
	display: block;
	margin: 0 auto 4pt auto;
	image-rendering: -webkit-optimize-contrast;
	image-rendering: crisp-edges;
	image-rendering: high-quality;
	-webkit-print-color-adjust: exact;
	print-color-adjust: exact;
}

.provider-name {
	font-size: 10pt;
	font-weight: 600;
	color: var(--print-text);
}

.country-info {
	font-size: 9pt;
	color: var(--print-text-muted);
}

/* Price */
.price-value {
	font-size: 10pt;
	font-weight: 600;
	color: var(--print-text);
	white-space: nowrap;
}

/* --------------------------------------------------------------------------
   Financial Summary Table
   -------------------------------------------------------------------------- */
.financial-section {
	margin-top: 12pt;
}

.financial-table {
	width: 100%;
	max-width: 300pt;
	border-collapse: collapse;
	border: 1px solid var(--print-border);
}

.rtl .financial-table {
	margin-left: auto;
	margin-right: 0;
}

.ltr .financial-table {
	margin-left: 0;
	margin-right: auto;
}

.financial-table td {
	border: 1px solid var(--print-border);
	padding: 6pt 10pt;
	font-size: 9pt;
}

.financial-table .label {
	font-weight: 600;
	color: var(--print-secondary);
	width: 50%;
}

.financial-table .value {
	text-align: end;
	font-weight: 600;
	color: var(--print-text);
}

.financial-table .value.discount {
	color: #c0392b;
}

.financial-table .total-row {
	background: var(--print-bg-header);
}

.financial-table .total-row .label,
.financial-table .total-row .value {
	font-size: 10pt;
	font-weight: 700;
	color: var(--print-primary);
}

/* --------------------------------------------------------------------------
   Terms & Conditions Table
   -------------------------------------------------------------------------- */
.terms-section {
	margin-top: 12pt;
}

.terms-table {
	width: 100%;
	border-collapse: collapse;
	border: 1px solid var(--print-border);
}

.terms-table td {
	border: 1px solid var(--print-border);
	padding: 6pt 10pt;
	font-size: 8pt;
}

.terms-table .label {
	font-weight: 600;
	color: var(--print-secondary);
	width: 100pt;
}

.terms-table .value {
	color: var(--print-text);
}

/* --------------------------------------------------------------------------
   Footer
   -------------------------------------------------------------------------- */
.offer-footer {
	margin-top: 16pt;
	padding-top: 8pt;
	border-top: 1px solid var(--print-border-light);
}

.footer-row {
	display: flex;
	gap: 8pt;
	margin-bottom: 4pt;
	font-size: 10pt;
}

.footer-row .label {
	font-weight: 600;
	color: var(--print-secondary);
}

.footer-row .value {
	color: var(--print-text);
}

/* --------------------------------------------------------------------------
   Print Styles (@media print)
   -------------------------------------------------------------------------- */
@media print {
	/* Reset body margin for printing */
	body {
		margin: 0 !important;
		padding: 0 !important;
	}

	/* Page setup */
	@page {
		size: A4 portrait;
		margin: 0;
	}

	/* Container fills page */
	.offer-print-container {
		width: 100%;
		min-height: 100vh;
		margin: 0;
		padding: 0;
		box-shadow: none;
		border: none;
	}

	/* Letterhead not needed in print - using product-page background */
	.letterhead-background {
		display: none;
	}

	/* Product page - LETTERHEAD as background only, completely separate from content */
	.product-page {
		width: 100%;
		min-height: 100vh;
		height: 100vh; /* Fixed height to ensure letterhead covers full page */
		page-break-after: always;
		page-break-before: auto;
		page-break-inside: avoid;
		/* LETTERHEAD: Background layer only - does NOT affect content positioning */
		background-image: var(--letterhead-url);
		background-repeat: no-repeat;
		background-size: 100% 100%; /* Cover entire page - use 100% 100% for better export */
		background-position: center center;
		-webkit-print-color-adjust: exact;
		print-color-adjust: exact;
		margin: 0;
		padding: 0; /* No padding - letterhead is background only, content is separate */
		display: block;
		image-rendering: -webkit-optimize-contrast;
		image-rendering: pixelated;
		image-rendering: crisp-edges;
	}

	.product-page:first-child {
		page-break-before: avoid;
	}

	.product-page:last-child {
		page-break-after: auto;
	}

	/* Content area - CONTENT completely separate from letterhead */
	/* CONTENT is 50% of page (25% top + 25% bottom = 50% total) */
	/* Content positioning is independent - letterhead is just a visual background */
	/* If content exceeds this 50% area, it automatically wraps to next page via CSS page-break */
	.page-content {
		position: relative;
		z-index: 2; /* Above letterhead background */
		padding: 25% 15mm 25% 15mm; /* CONTENT padding: 25% top, 25% bottom, 15mm sides - ALWAYS */
		/* Content area = 100% - 25% (top) - 25% (bottom) = 50% of page */
		margin: 0; /* No margin - completely separate from letterhead */
		background: transparent; /* No background - letterhead is separate layer */
		/* Content positioning is independent - letterhead does NOT affect it */
		/* Page-break properties handle wrapping when content exceeds 50% */
	}

	/* Prevent elements from breaking across pages */
	.product-row,
	.financial-table tr,
	.terms-table tr {
		page-break-inside: avoid;
	}

	/* Force page break when content exceeds 50% area (25% top + 25% bottom) */
	/* This ensures content automatically wraps to next page when it exceeds the content area */
	/* Same logic as jsPDF: if (yPos + height > contentEndY) { addPage(); } */
	.products-section,
	.financial-section,
	.terms-section {
		page-break-after: auto;
		page-break-before: auto;
		orphans: 3;
		widows: 3;
	}

	/* Products table - allow breaking across pages when content exceeds 50% area */
	.products-table {
		page-break-inside: auto; /* Allow table to break across pages */
	}

	/* Product rows - avoid breaking individual rows, but allow page break between rows */
	/* This mimics jsPDF logic: check if row exceeds contentEndY before drawing */
	.product-row {
		page-break-inside: avoid; /* Don't break individual rows */
		page-break-after: auto; /* Allow page break after rows when exceeding 50% area */
	}

	/* Special handling for 2 products: ensure second product wraps if content exceeds 50% */
	.product-row:nth-child(2) {
		page-break-before: auto; /* Allow page break before second product if content exceeds 50% */
	}

	/* Ensure products table respects 50% content area and allows proper page breaking */
	.products-table {
		page-break-inside: auto; /* Allow table to break across pages */
	}

	/* When there are exactly 2 products, check if they fit in 50% content area */
	/* If header + first product + second product exceeds 50%, second product should wrap */
	.products-section:has(.product-row:nth-child(2))
		.product-row:nth-child(2) {
		page-break-before: auto; /* Allow break if content exceeds 50% */
	}

	/* Section breaks */
	.products-section,
	.financial-section,
	.terms-section {
		page-break-before: auto;
		page-break-after: auto;
	}

	/* Hide screen-only elements */
	.no-print {
		display: none !important;
	}

	/* Ensure images print */
	img {
		-webkit-print-color-adjust: exact;
		print-color-adjust: exact;
	}

	/* Force background colors/images */
	* {
		-webkit-print-color-adjust: exact !important;
		print-color-adjust: exact !important;
	}
}

/* --------------------------------------------------------------------------
   Screen Preview Styles
   -------------------------------------------------------------------------- */
@media screen {
	.offer-print-container {
		box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
		margin: 20px auto;
	}
}
